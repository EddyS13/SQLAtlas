<UserControl x:Class="DatabaseVisualizer.Views.DataMaskingView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             mc:Ignorable="d" 
             d:DesignHeight="600" d:DesignWidth="800">
    
    <DockPanel Margin="10">
        <TextBlock DockPanel.Dock="Top" Margin="0,0,0,10" FontWeight="ExtraBold" FontSize="16"
                   Foreground="{StaticResource AccentColor}"
                   Text="Dynamic Data Masking Manager (Sensitive Data Audit)"/>

        <Button Content="Refresh Masking Audit" 
                DockPanel.Dock="Top" 
                Margin="0,0,0,10"
                Padding="5"
                x:Name="RefreshMaskingButton" 
                Click="RefreshMaskingButton_Click"/>

        <DataGrid x:Name="MaskingCandidatesGrid" 
                  HeadersVisibility="Column" 
                  AutoGenerateColumns="False"
                  Height="Auto"
                  MaxHeight="500"
                  CanUserAddRows="False">
            <DataGrid.Columns>
                <DataGridTextColumn Header="Table" Binding="{Binding SchemaTableName}" Width="*"/>
                <DataGridTextColumn Header="Column" Binding="{Binding ColumnName}" Width="1.2*"/>
                <DataGridTextColumn Header="Data Type" Binding="{Binding DataType}" Width="Auto"/>
                <DataGridCheckBoxColumn Header="Masked?" Binding="{Binding IsMasked}" Width="Auto"/>
                <DataGridTextColumn Header="Function" Binding="{Binding MaskingFunction}" Width="2*"/>

                <DataGridTemplateColumn Header="Action" Width="100">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <Button Content="{Binding IsMasked, Converter={StaticResource BoolToActionConverter}}" 
                                    Click="ApplyMaskingActionButton_Click" 
                                    CommandParameter="{Binding MaskingScript}"/>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>
            </DataGrid.Columns>
        </DataGrid>

        <TextBlock x:Name="NoCandidatesTextBlock" 
               Text="— No sensitive data columns found for auditing or masking. —" 
               FontStyle="Italic" 
               HorizontalAlignment="Center" 
               VerticalAlignment="Center"
               Foreground="{StaticResource FontColor}"
               Visibility="Collapsed"/>
        
    </DockPanel>
</UserControl>